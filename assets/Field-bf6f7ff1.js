import{j as r,c as l}from"./locales-548059eb.js";import{r as d,R as D}from"./react-libs-840bfe49.js";import{a as C}from"./index-59db7e48.js";import{C as xe}from"./index-9549eced.js";import{D as ye}from"./index-7a676a8e.js";import{C as be}from"./ConfigProviderContext-0f984393.js";import{C as je}from"./constant-7552c2aa.js";import{r as Ie}from"./scroll-e4e20d56.js";import{f as Ne}from"./number-b57f7cd4.js";import{i as O,c as Re}from"./base-1da74170.js";import{a as Ee}from"./unit-bb3e6514.js";import{p as Fe}from"./event-07a78c2b.js";const ve="16px",K=d.forwardRef((e,B)=>{const{prefixCls:_,createNamespace:A}=d.useContext(be),[c]=A("field",_),[v,k]=d.useState(!1),H=d.useRef(null),s=d.useRef(null),[W,P]=D.useState(!1);d.useEffect(()=>{e.getFieldRef&&e.getFieldRef(H),e.getInputRef&&e.getInputRef(s)},[e.getFieldRef,e.getInputRef]);const $=()=>{var t;(t=s.current)==null||t.focus()},x=()=>{var t;(t=s.current)==null||t.blur()};d.useImperativeHandle(B,()=>({focus:$,blur:x}));const m=t=>O(e[t])?e[t]:null,y=()=>String(e.value??""),U=d.useMemo(()=>{const t=m("readonly");if(e.clearable&&!t){const i=y()!=="",a=e.clearTrigger==="always"||e.clearTrigger==="focus"&&v;return i&&a}return!1},[e.value,e.clearTrigger,v]),Y=()=>{const t=m("labelWidth");return t?{width:Ee(t)}:{}},q=()=>{const t=s.current;if(!(e.type==="textarea"&&e.autosize)||!t)return;t.style.height="auto";let i=t.scrollHeight;if(Re(e.autosize)){const{maxHeight:a,minHeight:u}=e.autosize;a&&(i=Math.min(i,a)),u&&(i=Math.max(i,u))}i&&(t.style.height=`${i}px`)};d.useEffect(()=>{q()},[e.value]);const Z=()=>{const{type:t,name:i,rows:a,value:u,placeholder:g,disabled:T,readonly:j,onClickInput:I}=e,N=c("control",[m("inputAlign"),{custom:!!e.children,"min-height":e.type==="textarea"&&!e.autosize}]);if(e.children)return r.jsx("div",{className:l(N),onClick:I,children:e.children});const Ce=n=>{const{maxlength:o}=e;if(O(o)&&n.length>o&&!W){const f=y();return f&&f.length===+o?f:n.slice(0,+o)}return n},R=(n,o="onChange")=>{if(n=Ce(n),e.type==="number"||e.type==="digit"){const f=e.type==="number";n=Ne(n,f,f)}e.formatter&&o===e.formatTrigger&&(n=e.formatter(n)),s.current&&s.current.value!==n&&(s.current.value=n),n!==e.value&&e.onChange&&typeof e.onChange=="function"&&e.onChange(n)},w=n=>{var f;const o=(f=n==null?void 0:n.target)==null?void 0:f.value;R(o,"onChange")},h=n=>{P(!0)},M=n=>{P(!1);const o=n.currentTarget.value;R(o)},z=n=>{const{onFocus:o}=e;k(!0),o&&typeof o=="function"&&o(n),j&&x()},L=n=>{const{onBlur:o}=e;k(!1),R(y(),"onBlur"),o&&typeof o=="function"&&o(n),Ie()},V=n=>{const{onKeypress:o}=e;(n.key==="Enter"||+n.charCode==13)&&(e.type!=="textarea"&&Fe(n),e.type==="search"&&x()),o&&typeof o=="function"&&o(n)};if(t==="textarea")return r.jsx("textarea",{ref:s,name:i,rows:a,className:l(N),value:u,disabled:T,readOnly:j,placeholder:g||"",onBlur:L,onFocus:z,onClick:I,onChange:w,onKeyPress:V,onCompositionStart:h,onCompositionUpdate:h,onCompositionEnd:M});let E=t,F;return t==="number"&&(E="text",F="decimal"),t==="digit"&&(E="tel",F="numeric"),r.jsx("input",{value:u,type:E,inputMode:F,ref:s,name:i,className:l(N),disabled:T,readOnly:j,placeholder:g||"",onBlur:L,onFocus:z,onClick:I,onChange:w,onKeyPress:V,onCompositionStart:h,onCompositionUpdate:h,onCompositionEnd:M})},G=()=>{const{leftIcon:t,onClickLeftIcon:i}=e;return t?r.jsx("div",{className:l(c("left-icon")),onClick:i,children:typeof t!="string"?t:r.jsx(C,{name:t,classPrefix:e.iconPrefix})}):null},J=()=>{const{rightIcon:t,iconPrefix:i,onClickRightIcon:a}=e;return t?r.jsx("div",{className:l(c("right-icon")),onClick:a,children:typeof t=="string"?r.jsx(C,{name:t,classPrefix:i}):t}):null},Q=()=>{const{value:t,showWordLimit:i,maxlength:a}=e;if(i&&a){const u=(t?`${t}`:"").length;return r.jsxs("div",{className:l(c("word-limit")),children:[r.jsx("span",{className:l(c("word-num")),children:u}),"/",a]})}return null},X=()=>{const t=e.errorMessage;if(t){const i=m("errorMessageAlign");return r.jsx("div",{className:l(c("error-message",i)),children:t})}return null},p=()=>e.intro?r.jsx("div",{className:l(c("intro")),children:e.intro}):null,ee=()=>{const{tooltip:t}=e;if(t){let i=r.jsx(C,{name:"question-o"}),a={message:t};if(!(D.isValidElement(t)||typeof t=="string")){const{icon:u,...g}=t;i=u||i,a=g}return r.jsx("div",{className:l(c("tooltip")),onClick:()=>ye.show(a),children:i})}return null},te=()=>{const{label:t,colon:i}=e;return t?r.jsxs(r.Fragment,{children:[t,i&&":",ee()]}):null},ne=t=>{const{onClear:i,onChange:a}=e;s.current.value="",a&&typeof a=="function"&&a(""),i&&typeof i=="function"&&i(t)},{type:ie,size:oe,center:re,border:ae,isLink:le,required:ce,clickable:se,labelAlign:b,className:ue,labelClass:fe,arrowDirection:de,autosize:me,disabled:ge,button:S,error:he}=e;return r.jsxs(xe,{title:te(),size:oe,icon:G(),center:re,border:ae,isLink:le,required:ce,clickable:se,extra:e.extra,titleStyle:Y(),valueClass:l(c("value")),titleClass:l(c("label",b),fe),arrowDirection:de,onClick:e==null?void 0:e.onClick,className:l(c({error:he,disabled:ge,[`label-${b}`]:b,"min-height":ie==="textarea"&&!me}),ue),children:[r.jsxs("div",{className:l(c("body")),children:[Z(),U&&(typeof e.clearIcon=="string"?r.jsx(C,{className:l(c("clear")),onTouchStart:ne,name:e.clearIcon,size:ve}):e.clearIcon),J(),S&&r.jsx("div",{className:l(c("button")),children:S})]}),Q(),X(),p()]})});K.defaultProps={clearIcon:"clear",clearTrigger:"focus",formatTrigger:"onChange"};const ke=Symbol("field"),Pe=Object.assign(K,{[je]:ke}),Ae=Pe;export{Ae as F,ke as a};
