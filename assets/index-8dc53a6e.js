import{j as i,c as x}from"./locales-548059eb.js";import{r as j}from"./react-libs-840bfe49.js";import{c as q}from"./rc-cli_site-mobile-demo-eaa39090.js";import{a as P}from"./index-59db7e48.js";import{T as w}from"./index-439e92ef.js";import{C as G}from"./ConfigProviderContext-0f984393.js";import{u as Q}from"./use-mounted-ref-49b7ba77.js";import{u as A}from"./use-set-state-898f20ed.js";import{u as J}from"./use-update-effect-09c1ca0c.js";import{e as W}from"./base-1da74170.js";import{F as p}from"./Field-bf6f7ff1.js";import{P as T}from"./Popup-a2a0dcda.js";import{a as X}from"./index-9cdb6f61.js";import{T as L}from"./index-ec9d0b36.js";import"./mobile-e0307386.js";import"./unit-bb3e6514.js";import"./use-refs-92151253.js";import"./use-scroll-parent-a4dd715d.js";import"./use-event-listener-721bbec6.js";import"./Sticky-3cb62dae.js";import"./get-rect-4dc7f7e4.js";import"./scroll-e4e20d56.js";import"./raf-f0838b14.js";import"./index-945c9dff.js";import"./use-gesture-react.esm-484f41f1.js";import"./use-ref-state-6962d29d.js";import"./bound-41eb6e06.js";import"./interceptor-35467a90.js";import"./constant-7552c2aa.js";import"./PopupContext-0557b73d.js";import"./index-9549eced.js";import"./index-7a676a8e.js";import"./index-cffeb12c.js";import"./use-height-bc7f71cd.js";import"./render-38a34f7f.js";import"./number-b57f7cd4.js";import"./event-07a78c2b.js";import"./Overlay-d703c016.js";import"./use-touch-76dedc34.js";import"./CSSTransition-ea203202.js";import"./Loading-c60598b2.js";import"./lock-click-c7a7fb0f.js";const S={tabs:[],activeTab:0},B=t=>{const{prefixCls:C,createNamespace:r}=j.useContext(G),[s]=r("cascader",C),[d,b]=j.useState(void 0),[m,o]=A(S),c=Q(),{text:k,value:v,children:h}=W({text:"text",value:"value",children:"children"},t.fieldNames),F=(e,l)=>{for(let n=0;n<e.length;n++){const a=e[n];if(a[v]===l)return[a];if(a[h]){const u=F(a[h],l);if(u)return[a,...u]}}},E=()=>{if(d||d===0){const e=F(t.options,d);if(e){let l=t.options;const n=e.map(a=>{const u={options:l,selectedOption:a},f=l.find(g=>g[v]===a[v]);return f&&(l=f[h]),u});l&&n.push({options:l,selectedOption:null}),o({tabs:n}),setTimeout(()=>{c.current&&o({activeTab:n.length-1})},0);return}}o({tabs:[{options:t.options,selectedOption:null}]})},I=(e,l)=>{var f,g;if(e.disabled)return;let n=JSON.parse(JSON.stringify(m.tabs));if(n[l].selectedOption=e,n.length>l+1&&(n=n.slice(0,l+1)),e[h]){const N={options:e[h],selectedOption:null};n[l+1]?n[l+1]=N:n.push(N),o({tabs:n,activeTab:m.activeTab+1})}const a=n.map(N=>N.selectedOption).filter(Boolean),u={value:e[v],tabIndex:l,selectedOptions:a};b(e[v]),(f=t.onChange)==null||f.call(t,u),e[h]||(g=t.onFinish)==null||g.call(t,u)},D=()=>{var e;return(e=t.onClose)==null?void 0:e.call(t)},K=({name:e,title:l})=>{var n;o({activeTab:+e}),(n=t.onClickTab)==null||n.call(t,+e,l)},V=e=>{if(!e||!e.length)return S;try{const l={activeTab:e.length-1,tabs:[]};return e.reduce((n,a)=>{const u=n.find(f=>f[v]===a);if(!u)throw Error("Cascader: unable to match options correctly, Please check value or defaultValue props.");return l.tabs.push({options:n,selectedOption:u}),u[h]},t.options),l}catch(l){return console.error(l),S}},M=()=>t.closeable?typeof t.closeIcon=="string"?i.jsx(P,{name:t.closeIcon,className:x(s("close-icon")),onClick:D}):j.isValidElement(t.closeIcon)?t.closeIcon:null:null,z=()=>i.jsxs("div",{className:x(s("header")),children:[i.jsx("h2",{className:x(s("title")),children:t.title}),M()]}),H=(e,l,n)=>{const a=l&&e[v]===l[v],u=e.color||(a?t.activeColor:void 0),f=t.optionRender?t.optionRender({option:e,selected:a}):i.jsx("span",{children:e[k]});return i.jsxs("li",{className:x(s("option",{selected:a,disabled:e.disabled}),e.className),style:{color:u},onClick:()=>I(e,n),children:[f,a?i.jsx(P,{name:"success",className:x(s("selected-icon"))}):null]},e[v])},U=(e,l,n)=>i.jsx("ul",{className:x(s("options")),children:e.map(a=>H(a,l,n))},n),_=(e,l)=>{const{options:n,selectedOption:a}=e,u=a?a[k]:t.placeholder||"请选择";return i.jsx(w.TabPane,{title:u,titleClass:x(s("tab",{unselected:!a})),children:U(n,a,l)},l)},$=()=>i.jsx(w,{animated:!0,active:m.activeTab,className:x(s("tabs")),color:t.activeColor,swipeThreshold:0,swipeable:t.swipeable,onClickTab:K,children:m.tabs.map(_)});return j.useEffect(()=>{E()},[JSON.stringify(t.options)]),j.useEffect(()=>{const e=t.value??t.defaultValue;if(!e||Array.isArray(e)&&!e.length)return;const l=V(e);o(l)},[]),J(()=>{const e=V(t.value);o(e)},[t.value]),J(()=>{(d||d===0)&&m.tabs.map(l=>{var n;return(n=l.selectedOption)==null?void 0:n[v]}).includes(d)||E()},[d]),i.jsxs("div",{className:x(s()),children:[z(),m.tabs.length?$():null]})};B.defaultProps={closeable:!0,swipeable:!0,options:[],closeIcon:"cross"};const y=B;const O=[{text:"浙江省",value:"330000",children:[{text:"杭州市",value:"330100",children:[{text:"上城区",value:"330102"},{text:"下城区",value:"330103"},{text:"江干区",value:"330104"}]},{text:"宁波市",value:"330200",children:[{text:"海曙区",value:"330203"},{text:"江北区",value:"330205"},{text:"北仑区",value:"330206"}]},{text:"温州市",value:"330300",children:[{text:"鹿城区",value:"330302"},{text:"龙湾区",value:"330303"},{text:"瓯海区",value:"330304"}]}]},{text:"江苏省",value:"320000",children:[{text:"南京市",value:"320100",children:[{text:"玄武区",value:"320102"},{text:"秦淮区",value:"320104"},{text:"建邺区",value:"320105"}]},{text:"无锡市",value:"320200",children:[{text:"锡山区",value:"320205"},{text:"惠山区",value:"320206"},{text:"滨湖区",value:"320211"}]},{text:"徐州市",value:"320300",children:[{text:"鼓楼区",value:"320302"},{text:"云龙区",value:"320303"},{text:"贾汪区",value:"320305"}]}]}],Ke=()=>{const{DemoBlock:t,DemoSection:C}=q,[r,s]=A({v1:!1,t1:"",v2:!1,t2:"",v3:!1,t3:"",v4:!1,t4:"",v5:!1,t5:R(["330000","330100","330103"],O),value5:["330000","330100","330103"]}),[d,b]=j.useState([{text:"浙江省",value:"330000",children:[]}]),m=({value:o})=>{o===d[0].value&&(L.loading({message:"加载中...",duration:0}),setTimeout(()=>{L.clear();const c=JSON.parse(JSON.stringify(d));c[0].children=[{text:"杭州市",value:"330100"},{text:"宁波市",value:"330200"}],b(c)},2e3))};return i.jsxs(C,{className:"demo-cascader",children:[i.jsxs(t,{card:!0,title:"基础用法",children:[i.jsx(p,{isLink:!0,value:r.t1,readonly:!0,label:"地区",placeholder:"请选择所在地区",onClick:()=>s({v1:!0})}),i.jsx(T,{visible:r.v1,round:!0,position:"bottom",onClose:()=>s({v1:!1}),children:i.jsx(y,{title:"请选择所在地区",options:O,onClose:()=>s({v1:!1}),onFinish:({selectedOptions:o})=>{s({v1:!1,t1:o.map(c=>c.text).join("/")})}})})]}),i.jsxs(t,{card:!0,title:"自定义颜色",children:[i.jsx(p,{isLink:!0,value:r.t2,readonly:!0,label:"地区",placeholder:"请选择所在地区",onClick:()=>s({v2:!0})}),i.jsx(T,{visible:r.v2,round:!0,position:"bottom",onClose:()=>s({v2:!1}),children:i.jsx(y,{activeColor:"#f44336",title:"请选择所在地区",options:O,onClose:()=>s({v2:!1}),onFinish:({selectedOptions:o})=>{s({v2:!1,t2:o.map(c=>c.text).join("/")})}})})]}),i.jsxs(t,{card:!0,title:"异步加载选项",children:[i.jsx(p,{isLink:!0,value:r.t4,readonly:!0,label:"地区",placeholder:"请选择所在地区",onClick:()=>s({v4:!0})}),i.jsx(T,{visible:r.v4,round:!0,position:"bottom",onClose:()=>s({v4:!1}),children:i.jsx(y,{title:"请选择所在地区",options:d,onChange:m,onClose:()=>s({v4:!1}),onFinish:({selectedOptions:o})=>{s({v4:!1,t4:o.map(c=>c.text).join("/")})}})})]}),i.jsxs(t,{card:!0,title:"自定义字段名",children:[i.jsx(p,{isLink:!0,value:r.t3,readonly:!0,label:"地区",placeholder:"请选择所在地区",onClick:()=>s({v3:!0})}),i.jsx(T,{visible:r.v3,round:!0,position:"bottom",onClose:()=>s({v3:!1}),children:i.jsx(y,{fieldNames:{text:"name",value:"code",children:"items"},title:"请选择所在地区",options:[{name:"浙江省",code:"330000",items:[{name:"杭州市",code:"330100"}]},{name:"江苏省",code:"320000",items:[{name:"南京市",code:"320100"}]}],onClose:()=>s({v3:!1}),onFinish:({selectedOptions:o})=>{s({v3:!1,t3:o.map(c=>c.name).join("/")})}})})]}),i.jsxs(t,{card:!0,title:"受控组件",children:[i.jsx(p,{isLink:!0,value:r.t5,readonly:!0,label:"地区",placeholder:"请选择所在地区",errorMessage:i.jsxs("div",{children:["当前值:",JSON.stringify(r.value5)]}),onClick:()=>s({v5:!0})}),i.jsx(X,{type:"primary",size:"small",block:!0,onClick:()=>s({value5:["330000","330100","330104"],t5:R(["330000","330100","330104"],O)}),children:"外部设置"}),i.jsx(T,{visible:r.v5,round:!0,position:"bottom",onClose:()=>s({v5:!1}),children:i.jsx(y,{title:"请选择所在地区",value:r.value5,options:O,onClose:()=>s({v5:!1}),onFinish:({selectedOptions:o})=>{s({v5:!1,value5:o.map(c=>c.value),t5:o.map(c=>c.text).join("/")})}})})]})]})};function R(t,C){const r=[];return t.reduce((s,d)=>{const b=s.find(m=>m.value===d);return r.push(b.text),b.children},C),r.join("/")}export{Ke as default};
