import{j as v,c as x}from"./locales-548059eb.js";import{r,R as z}from"./react-libs-840bfe49.js";import{u as ce,a as ae,b as le}from"./use-gesture-react.esm-484f41f1.js";import{C as V}from"./ConfigProviderContext-0f984393.js";import{u as ue}from"./use-ref-state-6962d29d.js";import{b as X}from"./bound-41eb6e06.js";import{g as fe}from"./get-rect-4dc7f7e4.js";import{u as de}from"./use-mounted-ref-49b7ba77.js";import{n as me}from"./base-1da74170.js";const he=r.memo(({color:t="primary",direction:s="horizontal",...i})=>{const{prefixCls:w,createNamespace:f}=r.useContext(V),[d]=f("indicator",w),m=s==="vertical",g=[];for(let c=0;c<i.total;c++)g.push(v.jsx("div",{className:x(d("dot",{active:i.current===c}))},c));return v.jsx("div",{className:x(i.className,d({vertical:m})),style:{color:t,...i.style},children:g})}),ve=t=>{const{prefixCls:s,createNamespace:i}=r.useContext(V),[w]=i("swiper-item",s);return v.jsx("div",{className:x(t.className,w()),onClick:t.onClick,style:t.style,children:t.children})},q=ve;function ge(t,s){const i=Object.keys(t),w=Object.keys(s),f=new Set([...i,...w]),d={};return f.forEach(m=>{const g=t[m],c=s[m];typeof g=="function"&&typeof c=="function"?d[m]=function(...y){g(...y),c(...y)}:d[m]=g||c}),d}function O(t,s){const i=t%s;return i<0?i+s:i}const xe={mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp"};let b;const D=r.forwardRef((t,s)=>{const{prefixCls:i,createNamespace:w}=r.useContext(V),[f]=w("swiper",i),{loop:d,autoplay:m,direction:g,autoplayInterval:c}=t,[y]=r.useState({}),j=r.useRef(!1),E=r.useRef(null),[T,G]=r.useState(null),[P,B]=r.useState(t.defaultIndex),[W,A,p]=ue(!1),a=g==="vertical",H=r.useMemo(()=>a?"y":"x",[a]),S=t.slideSize/100,K=t.trackOffset/100,J=r.useMemo(()=>({[`--${i}-swipe-slide-size`]:`${t.slideSize}%`,[`--${i}-swipe-track-offset`]:`${t.trackOffset}%`,...t.style}),[t.style,t.slideSize,t.trackOffset]),Q=r.useMemo(()=>a?fe(T).height:100,[a,T]),{validChildren:Y,count:l}=r.useMemo(()=>{let e=0;return{validChildren:z.Children.map(t.children,o=>!z.isValidElement(o)||o.type!==q?null:(e++,o)),count:e}},[t.children]),U=r.useMemo(()=>l<=1?!1:d,[l,d]),Z=de(),$=()=>{const e=E.current;return e?(a?e.offsetHeight:e.offsetWidth)*t.slideSize/100:0},k=e=>{let n=0,o=l-1;return t.stuckAtBoundary&&(n+=(1-S-K)/S,o-=(1-S-K)/S),X(e,n,o)},[{position:C},I]=ce(()=>({position:k(P)*100,config:{tension:200,friction:30,autoplayInterval:c},onRest:()=>{if(p.current)return;const e=C.get(),n=100*l,o=O(e,n);o!==e&&I.start({position:o,immediate:!0})}}),[l]),M=r.useRef(null);function _(){var e;(e=M.current)==null||e.call(M),p.current=!1}const ee=ae(e=>{if(M.current=e.cancel,!e.intentional||(e.first&&!b&&(b=y),b!==y))return;b=e.last?void 0:y;const n=$();if(j.current||!n)return;const o=a?1:0,h=e.offset[o],u=e.direction[o],R=e.velocity[o];if(A(!0),!e.last)I.start({position:h*100/n,immediate:!0});else{const se=Math.round((h+Math.min(R*2e3,n)*u)/n);N(se),window.setTimeout(()=>{Z.current&&A(!1)})}},{transform:([e,n])=>[-e,-n],from:()=>{const e=$();return[C.get()/100*e,C.get()/100*e]},bounds:()=>{if(U)return{};const e=$(),n=k(0)*e,o=k(l-1)*e;return a?{top:n,bottom:o}:{left:n,right:o}},rubberband:!0,axis:H,preventScroll:!a,pointer:{touch:!0}}),te=()=>t.indicator===void 0||t.indicator===!0?v.jsx("div",{className:x(f("indicator",{vertical:a})),children:v.jsx(he,{...t.indicatorProps,direction:t.direction,total:l,current:P})}):typeof t.indicator=="function"?t.indicator(l,P):null,ne=e=>{p.current&&e.stopPropagation(),_()};function N(e,n=!1){var o,h;if(U){const u=O(e,l);B(u),(o=t.onIndexChange)==null||o.call(t,u),I.start({position:e*100,immediate:n})}else{const u=X(e,0,l-1);B(u),(h=t.onIndexChange)==null||h.call(t,u),I.start({position:k(u)*100,immediate:n})}}const F=()=>{N(Math.round(C.get()/100)+1)},oe=()=>{N(Math.round(C.get()/100)-1)};r.useImperativeHandle(s,()=>({activeIndex:P,swipeTo:N,swipeNext:F,swipePrev:oe,lock:()=>{j.current=!0},unlock:()=>{j.current=!1}})),r.useEffect(()=>{if(!m||W)return me;const e=window.setInterval(()=>{F()},c);return()=>{window.clearInterval(e)}},[m,W,Q]);const re={...t.allowTouchMove?ee():{}},L={};t.stopPropagation.forEach(e=>{const n=xe[e];L[n]=function(o){o.stopPropagation()}});const ie=ge(re,L);return v.jsxs("div",{ref:G,className:x(t.className,f({vertical:a})),style:J,children:[v.jsx("div",{ref:E,className:x(f("track",{"allow-touch-move":t.allowTouchMove})),onClickCapture:ne,...ie,children:v.jsx("div",{className:x(f("track-inner",{vertical:a})),children:z.Children.map(Y,(e,n)=>v.jsx(le.div,{className:x(f("slide")),style:{[H]:C.to(o=>{let h=-o+n*100;const u=l*100,R=u/2;return h=O(h+R,u)-R,`${h}%`}),left:`-${n*100}%`},children:e}))})}),te()]})});D.defaultProps={autoplay:!1,autoplayInterval:3e3,allowTouchMove:!0,defaultIndex:0,loop:!0,slideSize:100,stuckAtBoundary:!1,trackOffset:0,stopPropagation:[]};D.displayName="Swiper";const we=D,ye=Object.assign(we,{Item:q}),je=ye;export{je as S};
