import{j as S,c as $}from"./locales-548059eb.js";import{r as l}from"./react-libs-840bfe49.js";import{u as E}from"./use-scroll-parent-a4dd715d.js";import{u as P}from"./use-event-listener-721bbec6.js";import{g as x}from"./get-rect-4dc7f7e4.js";import{C as T}from"./ConfigProviderContext-0f984393.js";import{u as j}from"./use-set-state-898f20ed.js";import{u as k,b as B}from"./unit-bb3e6514.js";import{a as I,e as H}from"./base-1da74170.js";import{u as M}from"./use-update-effect-09c1ca0c.js";import{g as N}from"./scroll-e4e20d56.js";function O(t){const s=t;if(!s)return!1;const c=window.getComputedStyle(s),u=c.display==="none",e=s.offsetParent===null&&c.position!=="fixed";return u||e}function z(t,s){l.useEffect(()=>{if(!I||!window.IntersectionObserver)return;const c=new IntersectionObserver(h=>{s(h[0].intersectionRatio>0)},{root:document.body}),u=()=>{t.current&&c.observe(t.current)},e=()=>{t.current&&c.unobserve(t.current)};return u(),e},[t.current])}const b=t=>{const{prefixCls:s,createNamespace:c}=l.useContext(T),[u]=c("sticky",s),[e,h]=j({fixed:!1,width:0,height:0,transform:0}),d=l.useRef(null),y=E(d),i=l.useMemo(()=>k(t.position==="top"?t.offsetTop:t.offsetBottom),[t.position,t.offsetTop,t.offsetBottom]),p=l.useMemo(()=>{const{fixed:o,height:a,width:r}=e;return o?{width:`${r}px`,height:`${a}px`}:null},[e.fixed,e.height,e.width]),v=l.useMemo(()=>{if(!e.fixed)return null;const o=H(B(t.zIndex),{width:`${e.width}px`,height:`${e.height}px`,[t.position]:`${i}px`});return e.transform&&(o.transform=`translate3d(0, ${e.transform}px, 0)`),o},[t.position,e.fixed,i,e.width,e.height,e.transform]),C=(o,a)=>{t.onScroll&&t.onScroll({scrollTop:o,isFixed:a})},g=()=>{if(!d.current||O(d.current))return;const{container:o,position:a}=t,r=x(d.current),R=N(window),n={};if(n.width=r.width,n.height=r.height,a==="top")if(o){const f=x(o.current),m=f.bottom-i-n.height;n.fixed=i>r.top&&f.bottom>0,n.transform=m<0?m:0}else n.fixed=i>r.top;else{const{clientHeight:f}=document.documentElement;if(o){const m=x(o.current),w=f-m.top-i-n.height;n.fixed=f-i<r.bottom&&f>m.top,n.transform=w<0?-w:0}else n.fixed=f-i<r.bottom}h(n),C(R,n.fixed)};return P("scroll",g,{target:y}),z(d,g),M(()=>{var o;(o=t.onChange)==null||o.call(t,e.fixed)},[e.fixed]),S.jsx("div",{ref:d,style:p,children:S.jsx("div",{className:$(u({fixed:e.fixed})),style:v,children:t.children})})};b.defaultProps={offsetTop:0,offsetBottom:0,position:"top"};const Q=b;export{Q as S,O as i};
